# PADELFLOW CRITICAL PROTOCOL (THE IRON LAW)

## 0. PRE-FLIGHT CHECK (OBLIGATORIO)
Antes de generar una sola lÃ­nea de cÃ³digo o respuesta, DEBES ejecutar estos pasos mentalmente:
1.  Leer el archivo `CORE_ARCHITECTURE.md` (V3) en la raÃ­z.
2.  Verificar si tu tarea toca alguna tabla de la "Base de Datos".
3.  Verificar si tu tarea viola alguna regla de la secciÃ³n "THE KILL LIST".

## 0.1 SKILL ROUTING (AUTO-PILOT)
Before answering, analyze the user's request to detect intent. IF the request matches a Skill Trigger, you MUST adopt that Persona:

- If intent is **Visual/CSS/UI** -> ACTIVATE `.agent/skills/analyzing-ui`
- If intent is **Database/Schema** -> ACTIVATE `.agent/skills/guarding-architecture`
- If intent is **Logic/Calc/Bug** -> ACTIVATE `.agent/skills/auditing-logic`

**Output Indicator:**
Start your thought process with: "ðŸ§© Skill Activated: [Name]"

**TU PRIMERA LÃNEA DE RESPUESTA SIEMPRE DEBE SER:**
> "ðŸ›¡ï¸ Arquitectura V3 Verificada. [Mencionar quÃ© secciÃ³n aplica a esta tarea]"

## 1. INTEGRIDAD DE ARQUITECTURA (SQL-ONLY)
- **Strict Types:** `court_id` es UUID. `user_id` es UUID. NO inventes texto plano.
- **Link Perdido:** Si tocas `bookings`, recuerda que falta `member_id`. Si vas a insertar, ALERTA si no estÃ¡s solucionando eso primero.
- **No JSON:** Toda configuraciÃ³n va a tablas SQL (`opening_hours`, etc).

## 2. SEGURIDAD BLINDADA
- **Role-Gate:** NUNCA des acceso a 'club_staff' a rutas financieras o de configuraciÃ³n.
- **Scope-Gate:** Todo Query SQL debe filtrar por `entity_id` o `organization_id`.

## 3. PROTOCOLO DE AUTO-ACTUALIZACIÃ“N (DEFINITION OF DONE)
Una tarea NO estÃ¡ terminada hasta que hayas actualizado la documentaciÃ³n.
- Si cambiaste Schema SQL -> Actualiza `CORE_ARCHITECTURE.md` (SecciÃ³n 1 o 2).
- Si arreglaste un Bug LÃ³gico -> Mueve el item de la "Kill List" a "Solucionados".
- **Al final de tu respuesta, CONFIRMA:** "ðŸ“ DocumentaciÃ³n actualizada: [Nombre del cambio]" o "ðŸ“ Sin cambios en doc requeridos".

## 4. CONTEXTO LOCAL
- Idioma: EspaÃ±ol (Venezuela).
- Moneda: USD ($).
- Stack: Next.js 14, Supabase, Tailwind, Shadcn.

## 5. PROTOCOLO DE VERDAD (ANTI-ALUCINACIÃ“N)
Cuando se te pida auditar tipos de datos o esquema (Schema Check):
1. PROHIBIDO asumir el tipo de dato basÃ¡ndose en el cÃ³digo TypeScript.
2. OBLIGATORIO: Debes razonar como si consultaras `information_schema` en SQL.
3. Si vas a crear una relaciÃ³n (Foreign Key), SIEMPRE asume que el dato origen podrÃ­a ser TEXT y escribe la migraciÃ³n con `USING column::uuid` por seguridad, o verifica el tipo antes.

## 6. SKILL ROUTING (AUTO-PILOT)
Before answering, analyze the user's request to detect intent. IF the request matches a Skill Trigger, you MUST adopt that Persona:

- If intent is **Visual/CSS/UI** -> ACTIVATE `.agent/skills/analyzing-ui`
- If intent is **Database/Schema** -> ACTIVATE `.agent/skills/guarding-architecture`
- If intent is **Logic/Calc/Bug** -> ACTIVATE `.agent/skills/auditing-logic`

**Output Indicator:**
Start your thought process with: "ðŸ§© Skill Activated: [Name]"